{
id: "sinusoidal_flier_shooter",
prototype: ["ant_flying"],
properties: {
	try_facing: "def(int direction) -> commands if(direction != facing,fire_event('turn'))",
	sine_magnitude: "abs(_desired_height - magnitude)",
	shooting_appropriate: "if( (abs(mid_y - level.player.mid_y) < 20) and (level.cycle - last_fired) > 50 and (facing = sign(level.player.mid_x - mid_x)),1,0)",
	shoot: "[set(last_fired, level.cycle),spawn('sinusoidal_flier_shooter.shot',mid_x+20*facing,mid_y,facing)]",
	points_value: 14,

	init_x: { type: "int", init: "mid_x" },
	init_y: { type: "int", init: "mid_y"  },
	randphase: { type: "int", init: "1d500"  },
	last_fired: { type: "int", init: "0"  },
	magnitude: { type: "int", editor_info: { type: "y", value: "mid_y - 300" }, dynamic_initialization: true },
},

on_process_fly: "[check_if_we_should_turn_and_do_so_if_appropriate,
	            set(velocity_y, wave( min(250,max(-250, destination_height-midpoint_y ) ) )), if(shooting_appropriate, shoot) ] where destination_height = _desired_height + (sin(cycle*2 + randphase)*sine_magnitude)",
on_process_turn: "fire_event('process_fly')",

solid_area: null,
editor_info: {
	category: "enemies, experimental",
},
animation: [
	{
		image: "enemies/bat-black.png",
		pad: 3,
		body_area: "all",
		accel_y: 0,
		feet_x: 12,
		feet_y: 25,
		id: "cling",
		rect: [1,1,18,28],
		frames: 2,
		duration: 16,
		accel_x: 0,
	},
	{
		image: "enemies/bat-black.png",
		pad: 3,
		body_area: "all",
		accel_y: 0,
		feet_x: 12,
		feet_y: 25,
		id: "wake",
		rect: [43,1,60,28],
		frames: 1,
		duration: 6,
		accel_x: 0,
	},
	{
		image: "enemies/bat-black.png",
		pad: 3,
		body_area: "all",
		accel_y: 0,
		feet_x: 12,
		feet_y: 25,
		id: "fly",
		rect: [1,32,26,70],
		frames: 4,
		duration: 4,
		accel_x: 4,
	},
	{
		image: "enemies/bat-black.png",
		pad: 3,
		body_area: "all",
		accel_y: 0,
		feet_x: 12,
		feet_y: 25,
		id: "spring",
		rect: [1,32,26,70],
		frames: 1,
		duration: 3,
	},
	{
		image: "enemies/bat-black.png",
		pad: 3,
		body_area: "all",
		accel_y: 0,
		feet_x: 12,
		feet_y: 25,
		id: "turn",
		rect: [1,74,26,112],
		frames: 2,
		duration: 3,
	},
	{
		image: "enemies/bat-black.png",
		pad: 3,
		body_area: "all",
		accel_y: 0,
		feet_x: 12,
		feet_y: 25,
		id: "hurt",
		rect: [120,32,145,70],
	},
],
object_type: [
	{
		id: "shot",
		prototype: ["shot"],
		traction_in_air: 1000,
		timer_frequency: 200,
		on_timer: "force_death()",
		animation: {
			image: "enemies/generic.png",
			id: "normal",
			duration: 60,
			rect: [90,5,102,17],
			frames: 1,
			attack_area: "all",
			accel_x: 20,
		},
	},
	{
		id: "thrown",
		prototype: ["throwable_small_enemy"],

		properties: {
			taxonomy: "'bug'",
			acquirable_item_drop_value: 10,					
			points_value: 14,
		},
		animation: [
			{
				image: "enemies/bat-black.png",
				id: "thrown",
				thrown_area: "all",
				duration: 60,
				rect: [149,32,174,70],
				frames: 1,
				body_area: null,
			},
			{
				image: "enemies/bat-black.png",
				id: "on_back",
				rect: [149,32,174,70],
				frames: 2,
				duration: 5,
				body_area: "all",
			},
		],
	},
],
}
